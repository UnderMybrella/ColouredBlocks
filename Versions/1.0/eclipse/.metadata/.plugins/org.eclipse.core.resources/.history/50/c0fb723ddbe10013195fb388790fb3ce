package org.abimon.mods.minecraft.deco;

import java.util.ArrayList;
import java.util.Random;
import java.util.Set;

import cpw.mods.fml.common.registry.GameData;
import net.minecraft.block.Block;
import net.minecraft.block.BlockContainer;
import net.minecraft.block.material.Material;
import net.minecraft.client.Minecraft;
import net.minecraft.item.Item;
import net.minecraft.item.ItemStack;
import net.minecraft.tileentity.TileEntity;
import net.minecraft.world.World;

public class DecoBlock extends BlockContainer {

	protected DecoBlock(Material p_i45394_1_) {
		super(p_i45394_1_);
		// TODO Auto-generated constructor stub
	}

	/**
	 * This returns a complete list of items dropped from this block.
	 *
	 * @param world The current world
	 * @param x X Position
	 * @param y Y Position
	 * @param z Z Position
	 * @param metadata Current metadata
	 * @param fortune Breakers fortune level
	 * @return A ArrayList containing all items this block drops
	 */
	public ArrayList<ItemStack> getDrops(World world, int x, int y, int z, int metadata, int fortune)
	{
		ArrayList<ItemStack> ret = new ArrayList<ItemStack>();

		ret.add(new ItemStack(this, 1));

		return ret;
	}

	@Override
	public TileEntity createNewTileEntity(World var1, int var2) {
		return new DecoTileEntity();
	}

	public int getRenderType()
	{
		return DecorationMod.RENDER;
	}

	@Override
	public void onPostBlockPlaced(World world, int x, int y, int z, int metadata) 
	{
		System.out.println(world.isRemote);
		if(!world.isRemote)
		{
			TileEntity te = world.getTileEntity(x, y, z);

			if(te instanceof DecoTileEntity)
			{
				DecoTileEntity dte = (DecoTileEntity) te;
				Set<String> blocks = GameData.getBlockRegistry().getKeys();
				int block = new Random().nextInt(blocks.size());
				dte.using = new ItemStack(GameData.getBlockRegistry().getObject((String) blocks.toArray()[block]));
				Minecraft.getMinecraft().renderGlobal.markBlockForUpdate(x, y, z);
			}
		}
		else
		{
			Minecraft.getMinecraft().renderGlobal.markBlockForRenderUpdate(x, y, z);
			Minecraft.getMinecraft().renderGlobal.markBlockForUpdate(x, y, z);
		}
	}

}
