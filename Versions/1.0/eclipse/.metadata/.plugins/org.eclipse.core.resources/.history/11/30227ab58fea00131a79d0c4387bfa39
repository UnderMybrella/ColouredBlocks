package org.abimon.mods.minecraft.dnc;

import java.awt.Color;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Random;

import cpw.mods.fml.relauncher.Side;
import cpw.mods.fml.relauncher.SideOnly;
import net.minecraft.block.Block;
import net.minecraft.entity.EntityLivingBase;
import net.minecraft.init.Blocks;
import net.minecraft.potion.Potion;
import net.minecraft.potion.PotionEffect;
import net.minecraft.world.World;

public class PotionDnC extends Potion
{

	public String name = " Not Addedness";

	public PotionDnC(int par1, boolean par2, int par3) {
		super(par1, par2, par3);
	}

	@Override
	public void performEffect(EntityLivingBase par1EntityLivingBase, int par2)
	{
		if(this.id == DungeonsAndCreepers.ender.id)
		{
			par2++;
			int[] location = getNewLocation(par1EntityLivingBase.worldObj, (int) par1EntityLivingBase.posX, (int) par1EntityLivingBase.posY, (int) par1EntityLivingBase.posZ, 8 * par2, 16, par2 * 8, true);
			if(!par1EntityLivingBase.worldObj.isRemote)
				par1EntityLivingBase.worldObj.getEntityByID(par1EntityLivingBase.getEntityId()).moveEntity(location[0], location[1], location[2]);;
		}
		else if(this.id == DungeonsAndCreepers.purging.id)
		{
			while(true)
			{
				try
				{
					par1EntityLivingBase.clearActivePotions();
					break;
				}
				catch(Throwable th){}
			}
		}

	}

	public void affectEntity(EntityLivingBase par1EntityLivingBase, EntityLivingBase par2EntityLivingBase, int par3, double par4)
	{
		performEffect(par2EntityLivingBase, par3);
	}

	public int[] getNewLocation(World w, int startingX, int startingY, int startingZ, int rangeX, int rangeY, int rangeZ, boolean playerCheck)
	{
		int x = new Random().nextInt(rangeX) - (rangeX / 2);
		int y = startingY;
		int z = new Random().nextInt(rangeZ) - (rangeZ / 2);

		for(int i = 1; i < 256; i++)
		{
			Block one = w.getBlock(x, i - 1, z);
			if(!(one.getUnlocalizedName().equals(Blocks.air.getUnlocalizedName())))
				continue;
			Block two = w.getBlock(x, i, z);
			if(!(two.getUnlocalizedName().equals(Blocks.air.getUnlocalizedName())))
				continue;
			y = i;
			break;
		}

		return new int[]{startingX + x, y + 1, startingZ + z};
	}

	public boolean isReady(int duration, int amplifier)
	{
		if(duration % 40 == 0)
			return true;
		return false;
	}

	public boolean isInstant()
	{
		return this.id == DungeonsAndCreepers.purging.id;
	}
	
    public int getStatusIconIndex()
    {
        return Potion.digSpeed.getStatusIconIndex();
    }

}
